<view class="page" style="--page-nav-height: {{navBarHeight}}px;">
  <view class="status" />

  <view class="header">
    <view class="progress">
      <view class="progress__bar">
        <view class="progress__fill" style="width: {{progressPercent}}%;" />
      </view>
    </view>

    <view class="actions row between">
      <view class="icon-btn" bindtap="onPrev">
        <image class="action-icon" mode="aspectFit" src="/assets/image/uni-left.png" />
      </view>
      <view class="icon-btn close" bindtap="onClose">
        <image class="action-icon" mode="aspectFit" src="/assets/image/uni-close.svg" />
      </view>
    </view>
  </view>

  <scroll-view class="body" scroll-y="true" enhanced="true" show-scrollbar="false">
    <view class="title">{{currentItem.content}}</view>

    <view class="swap" bindtap="onSwap">
      <view class="swap__icon">⟳</view>
      <view class="swap__text">换个题目</view>
    </view>

    <view class="options">
      <view
        wx:for="{{currentOptions}}"
        wx:key="optionId"
        class="opt {{item._selected ? 'opt--on' : 'opt--off'}}"
        bindtap="onToggleOption"
        data-option-id="{{item.optionId}}"
      >
        {{item.content}}
      </view>
    </view>
    <view class="spacer" />
  </scroll-view>

  <view class="footer safe-bottom">
    <view wx:if="{{answeredCount < 5}}">
      <button class="btn-cta {{canNext ? '' : 'btn-cta--disabled'}}" disabled="{{!canNext}}" bindtap="onNext">
        {{isLast ? '提交' : '下一题'}}
      </button>
    </view>
    <view wx:else class="dual">
      <button class="btn-cta {{canContinue ? '' : 'btn-cta--disabled'}}" disabled="{{!canContinue}}" bindtap="onContinue">
        继续做题
      </button>
      <button class="btn-cta {{canSubmit ? '' : 'btn-cta--disabled'}}" disabled="{{!canSubmit}}" bindtap="onSubmit">
        提交
      </button>
    </view>
  </view>
</view>
